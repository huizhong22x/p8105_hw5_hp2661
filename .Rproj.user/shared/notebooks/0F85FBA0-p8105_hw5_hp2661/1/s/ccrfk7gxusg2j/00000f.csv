"0","set.seed(1)"
"0",""
"0","# calculate power"
"0","my_power = function(mu_0, n = 30, sigma = 5) {"
"0","  x = rnorm(n, mean = mu_0, sd = sigma)"
"0",""
"0","  t_result = t.test(x, mu = 0) |> broom::tidy()"
"0","  "
"0","  tibble("
"0","    estimate = t_result$estimate,"
"0","    p_value = t_result$p.value"
"0","  )"
"0","}"
"0",""
"0","# for mu list"
"0","sim_powers_df = function(mu_list, iteration = 5000){"
"0","  expand_grid("
"0","    mu = mu_list,"
"0","    iter = 1:iteration"
"0","  ) |> "
"0","  mutate("
"0","    estimate_df = map(mu, my_power)"
"0","  ) |> "
"0","  unnest(estimate_df)"
"0","}"
"0",""
"0","# result"
"0","mu_list = 0:6"
"0","sim_results_df = sim_powers_df(mu_list)"
"0",""
"0","sim_results_plot = sim_results_df |> "
"0","  group_by(mu) |> "
"0","  summarize("
"0","    rej_rate = mean(p_value < .05)"
"0","  )"
